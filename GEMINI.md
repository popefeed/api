# PopeFeed - Pope Documents Aggregator

## Project Overview
PopeFeed is a modern social media-style platform that aggregates and displays papal documents from the Vatican in an accessible feed format with full multilanguage support. The project consists of two main components:

1. **Hugo Static Site Generator** (Frontend) - `/site/`
2. **Python Vatican Scraper** (Backend/API) - `/scrapper/`

## Architecture

### Frontend (Hugo)
- **Technology**: Hugo Extended (for SCSS support)
- **Structure**: Multilingual static site with PDF viewer
- **Languages**: EN, ES, PT, IT, FR, LA
- **Features**: Social media-style feed, PDF.js integration, language switching
- **API Integration**: Consumes JSON files generated by Python scraper

### Backend (Python Scraper)
- **Technology**: Python with aiohttp, BeautifulSoup, langdetect
- **Purpose**: Scrape Vatican documents and generate API structure
- **Output**: JSON files + PDF downloads in `/api/` directory
- **Features**: Multi-language scraping, PDF validation, concurrent downloads, Vatican image scraping

## Data Models

### Pope Model
```json
{
  "id": "francis",
  "names": {"en": "Pope Francis", "es": "Papa Francisco", ...},
  "images": {"photo": "/api/popes/francis.jpg", "coat_of_arms": "/api/popes/francis-arms.png"},
  "image_url": "https://www.vatican.va/content/dam/francesco/img/biografia/img/foto_hi-res_13-03-2013-24-26-58.jpg",
  "local_image_path": "/api/popes/francesco.jpg",
  "reign": {"start": "2013-03-13", "end": null},
  "biographies": {"en": "Pope Francis is...", "es": "El Papa Francisco es..."}
}
```

### Document Model
```json
{
  "id": "laudato-si-2015",
  "pope_id": "francis",
  "type": "encyclical",
  "titles": {"en": "Laudato Si'", "es": "Laudato Si'", ...},
  "available_languages": ["en", "es", "pt", "it", "fr", "la"],
  "local_pdfs": {"en": "/api/documents/laudato-si-2015/en.pdf", ...},
  "excerpts": {"en": "Praise be to you...", "es": "Alabado seas..."}
}
```

## Development Commands

### Hugo Site
```bash
# Development server
cd site && hugo server -D

# Build for production
cd site && hugo --minify

# Build with specific language
cd site && hugo --config config.toml,config-production.toml
```

### Python Scraper
```bash
# Install dependencies
cd scrapper && pip install -r requirements.txt

# Run scraper (basic)
python main.py

# Run scraper with specific languages
python main.py --languages en,es,pt,it,fr,la

# Resume interrupted scrape
python main.py --resume

# Download pope images from Vatican website
python scrapper/image_downloader.py

# Generate posts API with pope images
python generate_posts_api.py
```

## Project Structure
```
popefeed/
├── site/                    # Hugo static site
│   ├── config/
│   ├── content/
│   ├── layouts/
│   ├── assets/
│   └── i18n/
├── scrapper/               # Python scraper
│   ├── scrapper/
│   ├── models/
│   ├── api_generator/
│   └── requirements.txt
├── api/                    # Generated API files
│   ├── popes/              # Pope images downloaded from Vatican
│   ├── documents/
│   ├── posts/              # Paginated posts API
│   └── feed/
├── SETUP.md               # Complete project setup guide
├── README.md              # Quick start guide
└── CLAUDE.md              # This file
```

## Key Features
1. **Multilingual Support**: 6+ languages with automatic detection
2. **PDF Viewer**: Embedded PDF.js with side-by-side comparison
3. **Social Feed**: Instagram/LinkedIn-style card layout with real pope images
4. **Search & Filter**: By pope, document type, language, date
5. **Offline Support**: Service Worker for PDF caching
6. **Responsive Design**: Mobile-optimized PDF viewing
7. **Vatican Image Integration**: Official pope photographs from Vatican website

## Technical Requirements
- **Hugo Extended**: Latest version for SCSS support
- **Python 3.8+**: For scraper with async/await support
- **PDF.js v3.x**: For PDF rendering
- **Node.js**: For build tools and dependencies

## Development Notes
- Always check if PDF files are valid before adding to API
- Use meaningful variable names and avoid single-letter variables
- Test multilingual content thoroughly
- Ensure proper error handling for network requests
- Validate all JSON output before deployment
- Pope images are downloaded from Vatican website and stored locally
- Posts API generates paginated feeds with real pope avatars

## Success Metrics
- Support for 6+ languages
- 5000+ documents in multiple languages
- PDF rendering on all devices
- Language switch < 100ms
- Offline PDF access
- 95+ Lighthouse score

## Project Management
- Always use the "Development Phases" at ./SETUP.md as a TODO list to know and edit what we should make in this project, you can add subtask to ensure all work is planned